<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>reveal.js</title>

		<link rel="stylesheet" href="dist/reset.css">
		<link rel="stylesheet" href="dist/reveal.css">
		<link rel="stylesheet" href="dist/theme/serif.css">

		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="plugin/highlight/monokai.css">

		<style>
			.attribution{
				position:absolute;
				bottom:0;
				right:0;
				font-size:0.5em;
			}
		</style>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section data-markdown>
					<textarea data-template>
						## [Fitting Hierarchical Bayesian Models With Selection Effects in Astronomy](https://farr.github.io/FWAM2024HierarchicalSelection/)
						
						[Will M. Farr](https://farr.github.io)
						
						CCA 
						
						2024-10-24

						https://farr.github.io/FWAM2024HierarchicalSelection/

						---

						I work in the LIGO-Virgo-Kagra Collaboration (LVK).  We
						detect gravitational waves from merging black holes and
						neutron stars.

						<img class="r-stretch" src="images/ligo-hanford-aerial-04.jpg" />

						<span class="attribution"><a href="https://www.ligo.caltech.edu/WA/image/ligo20150731f">LIGO</a></span>

						---

						`$f_{\mathrm{GW},\mathrm{ISCO}} = 200 \, \mathrm{Hz} \frac{10 M_\odot}{M}$` <!-- .element: class="fragment"-->

						`$h = \mathcal{O}\left(1 \right) \frac{r_\mathrm{Schw}}{r} \simeq 2 \times 10^{-22} \, \frac{M}{10 M_\odot} \, \frac{10 Gpc}{r}$` <!-- .element: class="fragment"-->

						<img class="r-stretch" src="images/detection-figure3.png" />

						<span class="attribution"><a href="https://ui.adsabs.harvard.edu/abs/2016PhRvL.116f1102A/abstract">Abbott, et al. (2016)</a></span>

						---

						Evolution of LVK Catalogs: 2016

						<img class="r-stretch" src="images/o1.png" />

						<span class="attribution"><a href="https://ui.adsabs.harvard.edu/abs/2016PhRvX...6d1015A/abstract">Abbott, et al. (2016)</a> </span>

						---

						Evolution of LVK Catalogs: GWTC-1 (2017)

						<img class="r-stretch" src="images/gwtc-1.png" />

						<span class="attribution"><a href="https://arxiv.org/abs/1811.12907">Abbott, et al. (2019)</a></span>

						---

						Evolution of LVK Catalogs: GWTC-2 (2019)

						<img class="r-stretch" src="images/gwtc-2.png" />

						<span class="attribution"><a href="http://arxiv.org/abs/2010.14527">Abbott, et al. (2021)</a></span>

						---

						Evolution of LVK Catalogs: GWTC-3 (2020)

						<img class="r-stretch" src="images/gwtc-3.png" />

						<span class="attribution"><a href="http://arxiv.org/abs/2111.03606">Abbott, et al. (2021)</a></span>

						---

						Evolution of LVK Catalogs: Last Week at <a href="https://gracedb.ligo.org/superevents/public/O4/">GraceDB</a>

						<iframe class="r-stretch" data-src="https://gracedb.ligo.org/superevents/public/O4/" data-preload />

						---

						<img class="r-stretch" src="images/dRdm-gwtc3.png" />

						Now we know: <div class="fragment" data-fragment-index="1"> **But how?** </div>

						- The most common black hole mergers involve `$10 \, M_\odot$` black holes.  <span class="fragment" data-fragment-index="2">This is not most of what we see!</span>
						- The integrated rate is `$\sim 1 / 30 \, \mathrm{min}$` in the universe.  <span class="fragment" data-fragment-index="3">Today we see one every few days!</span>


						<span class="attribution"><a href="http://arxiv.org/abs/2111.03634">Abbott, et al. (2016)</a></span>

						---

						The actual observations:

						<img class="r-stretch" src="images/observed-dNdm.png" />

						- Observational Uncertainty <!-- .element: class="fragment" -->
						- Selection Effects <!-- .element: class="fragment" -->

						---

						<h2 class="r-fit-text">How Does this Work?</h2>

						---

						<h2 class="r-fit-text">What is an "observation?"</h2>

						Catalogs are Poisson point processes

						---

						Events have parameters `$x$` and occur with rate 
						
						`$$\frac{\mathrm{d}N}{\mathrm{d} x}$$`.

						---

						In each box of parameter space with volume `$\mathrm{d} x$` there are either:
						  - Zero events, with probability 
						    `$$\exp\left(- \frac{\mathrm{d}N}{\mathrm{d} x} \mathrm{d} x\right)$$`
						  - One event, with probability 
						    `$$\frac{\mathrm{d} N}{\mathrm{d} x} \mathrm{d} x \, \exp\left(- \frac{\mathrm{d}N}{\mathrm{d} x} \mathrm{d} x\right) $$`

						---

						Boxes are independent, so 

						`$$p\left(x_1, \ldots, x_N \right) = \left[ \prod_{i=1}^N \frac{\mathrm{d} N}{\mathrm{d} x_i} \right] \, \exp\left(- \sum_{\mathrm{boxes}} \frac{\mathrm{d}N}{\mathrm{d} x} \mathrm{d} x\right)$$`

						---

						Boxes are independent, so 

						`$$p\left(x_1, \ldots, x_N \right) = \left[ \prod_{i=1}^N \frac{\mathrm{d} N}{\mathrm{d} x_i} \right] \, \exp\left(- \int \mathrm{d} x \, \frac{\mathrm{d}N}{\mathrm{d} x} \right)$$`

						<p class="fragment">Where did the factorial go?</p>
						<p class="fragment">These events are distinguishable!</p>

						---

						Let's fit a Poisson process:

						`$$\frac{\mathrm{d}N}{\mathrm{d} x} = a \exp\left( - \frac{1}{2} \left[ \frac{x - \mu}{\sigma} \right]^2 \right)$$`

						- <div class="fragment">$a$ is the rate at the peak</div>
						- <div class="fragment">$\mu$ is the location of the peak</div>
						- <div class="fragment">$\sigma$ is the width (s.d.) of the peak</div>

						---

						```julia
						function population_logdensity_fn(a, mu, sigma)
						    	function pop_logdens(x)
						        	r = (x-mu)/sigma
						        	log(a) - r*r/2
						    	end
					    	pop_logdens
						end

						function population_normalization(a, mu, sigma)
						    a * sqrt(2*pi) * sigma
						end
						```
					</textarea>
				</section>
			</div>
		</div>

		<script src="dist/reveal.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script src="plugin/math/math.js"></script>
		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				hash: true,
				slideNumber: true,
				katex: {
    				local: 'node_modules/katex',
				},

				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes, RevealMath.KaTeX ]
			});
		</script>
	</body>
</html>
